<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç–ª–∞–¥–∫–∞ –≤—ã–∂–∏–≤–∞–Ω–∏—è - Evolution Game of Life</title>
    <style>
        body {
            font-family: monospace;
            background: #1a1a1a;
            color: #00ff00;
            padding: 20px;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #444;
            background: #2a2a2a;
        }
        .critical { color: #ff4444; }
        .warning { color: #ffaa00; }
        .ok { color: #44ff44; }
        button {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
        }
        button:hover { background: #666; }
    </style>
</head>
<body>
    <h1>üîç –û—Ç–ª–∞–¥–∫–∞ —Å–∏—Å—Ç–µ–º—ã –≤—ã–∂–∏–≤–∞–Ω–∏—è</h1>
    <p>–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã –≤—ã–∂–∏–≤–∞–Ω–∏—è —Å —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏</p>
    
    <button onclick="testSurvival()">üß¨ –¢–µ—Å—Ç –≤—ã–∂–∏–≤–∞–Ω–∏—è –ø—Ä–∏ -50¬∞C</button>
    <button onclick="testReproduction()">üë∂ –¢–µ—Å—Ç —Ä–∞–∑–º–Ω–æ–∂–µ–Ω–∏—è –ø—Ä–∏ —ç–∫—Å—Ç—Ä–∏–º–µ</button>
    <button onclick="simulateMassExtinction()">üíÄ –°–∏–º—É–ª—è—Ü–∏—è –º–∞—Å—Å–æ–≤–æ–≥–æ –≤—ã–º–∏—Ä–∞–Ω–∏—è</button>
    
    <div id="results"></div>

    <script>
        // –ö–æ–ø–∏—Ä—É–µ–º —Ç–æ—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –∏–≥—Ä—ã
        function calculateSurvivalChance(dna, neighborCount, temperature, pressure) {
            let baseChance = 0;
            
            if (dna.species === 'predator') {
                baseChance = neighborCount <= 1 ? 0.7 : neighborCount <= 3 ? 0.9 : 0.6;
            } else {
                if (neighborCount === 2 || neighborCount === 3) {
                    baseChance = 0.8;
                } else if (neighborCount === 1 || neighborCount === 4) {
                    baseChance = 0.3;
                } else {
                    baseChance = 0.05;
                }
            }

            const survivalBonus = dna.survival / 100 * 0.5;
            const adaptationBonus = dna.adaptation / 100 * 0.3;
            const energyPenalty = (100 - dna.energy) / 100 * 0.2;
            const agePenalty = Math.min(dna.age / 100, 0.3);
            
            // –ù–û–í–ê–Ø –ª–æ–≥–∏–∫–∞ —Å —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏
            const tempStress = Math.abs(temperature) / 50;
            const pressureStress = Math.abs(pressure - 50) / 50;
            
            let envPenalty = 0;
            if (tempStress > 0.8 || pressureStress > 0.8) {
                // –ü—Ä–∏ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö —à—Ç—Ä–∞—Ñ 70-90%
                envPenalty = 0.7 + (tempStress + pressureStress) * 0.1;
            } else {
                // –ü—Ä–∏ —É–º–µ—Ä–µ–Ω–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö –æ–±—ã—á–Ω—ã–π —à—Ç—Ä–∞—Ñ
                envPenalty = tempStress * 0.4 + pressureStress * 0.3;
            }
            
            // –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Å–Ω–∏–∂–∞–µ—Ç –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ —Å—Ä–µ–¥—ã, –Ω–æ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é
            const adaptationResistance = (dna.adaptation / 100) * 0.5;
            const finalEnvPenalty = envPenalty * (1 - adaptationResistance);
            
            return Math.max(0.01, Math.min(0.99, baseChance + survivalBonus + adaptationBonus - energyPenalty - agePenalty - finalEnvPenalty));
        }
        
        function calculateReproductionChance(avgReproduction, avgEnergy, temperature, pressure) {
            let baseChance = 0.7; // 3 —Å–æ—Å–µ–¥–∞
            const reproductionBonus = avgReproduction / 100;
            const energyBonus = avgEnergy / 100 * 0.3;
            
            // –ù–û–í–ê–Ø –ª–æ–≥–∏–∫–∞ —Ä–∞–∑–º–Ω–æ–∂–µ–Ω–∏—è
            const tempStress = Math.abs(temperature) / 50;
            const pressureStress = Math.abs(pressure - 50) / 50;
            
            let environmentalFactor;
            if (tempStress > 0.8 || pressureStress > 0.8) {
                environmentalFactor = 0.05; // —Ç–æ–ª—å–∫–æ 5% —à–∞–Ω—Å —Ä–∞–∑–º–Ω–æ–∂–µ–Ω–∏—è –ø—Ä–∏ —ç–∫—Å—Ç—Ä–µ–º–µ
            } else {
                environmentalFactor = 1 - (tempStress * 0.6 + pressureStress * 0.5);
            }
            
            return Math.max(0.01, Math.min(0.9, baseChance * reproductionBonus * energyBonus * environmentalFactor));
        }
        
        function testSurvival() {
            const results = document.getElementById('results');
            results.innerHTML = '<h2>üß¨ –¢–µ—Å—Ç –≤—ã–∂–∏–≤–∞–Ω–∏—è –ø—Ä–∏ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö</h2>';
            
            const testCases = [
                { name: '–û–±—ã—á–Ω–∞—è –∫–ª–µ—Ç–∫–∞, –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è', dna: {species: 'prey', survival: 50, adaptation: 50, energy: 80, age: 10}, neighbors: 3, temp: 0, pressure: 50 },
                { name: '–û–±—ã—á–Ω–∞—è –∫–ª–µ—Ç–∫–∞, -50¬∞C', dna: {species: 'prey', survival: 50, adaptation: 50, energy: 80, age: 10}, neighbors: 3, temp: -50, pressure: 50 },
                { name: '–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –∫–ª–µ—Ç–∫–∞, -50¬∞C', dna: {species: 'prey', survival: 80, adaptation: 90, energy: 90, age: 10}, neighbors: 3, temp: -50, pressure: 50 },
                { name: '–û–±—ã—á–Ω–∞—è –∫–ª–µ—Ç–∫–∞, –¥–∞–≤–ª–µ–Ω–∏–µ 100', dna: {species: 'prey', survival: 50, adaptation: 50, energy: 80, age: 10}, neighbors: 3, temp: 0, pressure: 100 },
                { name: '–•–∏—â–Ω–∏–∫, —ç–∫—Å—Ç—Ä–∏–º', dna: {species: 'predator', survival: 80, adaptation: 60, energy: 80, age: 20}, neighbors: 2, temp: -50, pressure: 100 },
                { name: '–°—Ç–∞—Ä–∞—è –∫–ª–µ—Ç–∫–∞, —ç–∫—Å—Ç—Ä–∏–º', dna: {species: 'prey', survival: 50, adaptation: 50, energy: 30, age: 150}, neighbors: 3, temp: -40, pressure: 90 }
            ];
            
            testCases.forEach(test => {
                const chance = calculateSurvivalChance(test.dna, test.neighbors, test.temp, test.pressure);
                const percent = (chance * 100).toFixed(1);
                
                let className = 'ok';
                if (chance > 0.5) className = 'warning';
                if (chance > 0.8) className = 'critical';
                if (test.temp === -50 && chance > 0.2) className = 'critical';
                
                results.innerHTML += `
                    <div class="test-result ${className}">
                        <strong>${test.name}:</strong> ${percent}% —à–∞–Ω—Å –≤—ã–∂–∏—Ç—å<br>
                        –£—Å–ª–æ–≤–∏—è: ${test.temp}¬∞C, ${test.pressure}–∞—Ç–º, ${test.neighbors} —Å–æ—Å–µ–¥–µ–π<br>
                        –î–ù–ö: –≤—ã–∂–∏–≤=${test.dna.survival}, –∞–¥–∞–ø—Ç=${test.dna.adaptation}, —ç–Ω–µ—Ä–≥=${test.dna.energy}, –≤–æ–∑—Ä=${test.dna.age}
                        ${className === 'critical' ? '<br><span style="color:red;">‚ö†Ô∏è –°–õ–ò–®–ö–û–ú –í–´–°–û–ö–ò–ô –®–ê–ù–° –î–õ–Ø –≠–ö–°–¢–†–ò–ú–ê!</span>' : ''}
                    </div>
                `;
            });
        }
        
        function testReproduction() {
            const results = document.getElementById('results');
            results.innerHTML = '<h2>üë∂ –¢–µ—Å—Ç —Ä–∞–∑–º–Ω–æ–∂–µ–Ω–∏—è –ø—Ä–∏ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö</h2>';
            
            const testCases = [
                { name: '–ù–æ—Ä–º–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è', avgReproduction: 60, avgEnergy: 80, temp: 0, pressure: 50 },
                { name: '–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ -50¬∞C', avgReproduction: 60, avgEnergy: 80, temp: -50, pressure: 50 },
                { name: '–î–∞–≤–ª–µ–Ω–∏–µ 100', avgReproduction: 60, avgEnergy: 80, temp: 0, pressure: 100 },
                { name: '–î–≤–æ–π–Ω–æ–π —ç–∫—Å—Ç—Ä–∏–º', avgReproduction: 80, avgEnergy: 90, temp: -50, pressure: 100 },
                { name: '–£–º–µ—Ä–µ–Ω–Ω—ã–π —Ö–æ–ª–æ–¥', avgReproduction: 70, avgEnergy: 80, temp: -30, pressure: 50 }
            ];
            
            testCases.forEach(test => {
                const chance = calculateReproductionChance(test.avgReproduction, test.avgEnergy, test.temp, test.pressure);
                const percent = (chance * 100).toFixed(1);
                
                let className = 'ok';
                if (chance > 0.3) className = 'warning';
                if (chance > 0.5) className = 'critical';
                if ((test.temp === -50 || test.pressure === 100) && chance > 0.1) className = 'critical';
                
                results.innerHTML += `
                    <div class="test-result ${className}">
                        <strong>${test.name}:</strong> ${percent}% —à–∞–Ω—Å —Ä–∞–∑–º–Ω–æ–∂–µ–Ω–∏—è<br>
                        –£—Å–ª–æ–≤–∏—è: ${test.temp}¬∞C, ${test.pressure}–∞—Ç–º<br>
                        –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è: —Ä–∞–∑–º–Ω=${test.avgReproduction}, —ç–Ω–µ—Ä–≥=${test.avgEnergy}
                        ${className === 'critical' ? '<br><span style="color:red;">‚ö†Ô∏è –†–ê–ó–ú–ù–û–ñ–ï–ù–ò–ï –î–û–õ–ñ–ù–û –ë–´–¢–¨ –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù–û!</span>' : ''}
                    </div>
                `;
            });
        }
        
        function simulateMassExtinction() {
            const results = document.getElementById('results');
            results.innerHTML = '<h2>üíÄ –°–∏–º—É–ª—è—Ü–∏—è –º–∞—Å—Å–æ–≤–æ–≥–æ –≤—ã–º–∏—Ä–∞–Ω–∏—è (1000 –∫–ª–µ—Ç–æ–∫)</h2>';
            
            const population = [];
            for (let i = 0; i < 1000; i++) {
                population.push({
                    species: Math.random() < 0.15 ? 'predator' : 'prey',
                    survival: 30 + Math.random() * 40, // 30-70
                    adaptation: 20 + Math.random() * 60, // 20-80
                    energy: 60 + Math.random() * 40, // 60-100
                    age: Math.random() * 50 // 0-50
                });
            }
            
            const conditions = [
                { name: '–ù–æ—Ä–º–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è', temp: 0, pressure: 50 },
                { name: '–ê—Ä–∫—Ç–∏—á–µ—Å–∫–∏–π —Ö–æ–ª–æ–¥ (-50¬∞C)', temp: -50, pressure: 50 },
                { name: '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ (100)', temp: 0, pressure: 100 },
                { name: '–ê–¥—Å–∫–∏–π —ç–∫—Å—Ç—Ä–∏–º (-50¬∞C, 100–∞—Ç–º)', temp: -50, pressure: 100 }
            ];
            
            conditions.forEach(condition => {
                let survivors = 0;
                let canReproduce = 0;
                
                population.forEach(cell => {
                    const survivalChance = calculateSurvivalChance(cell, 3, condition.temp, condition.pressure);
                    const reproductionChance = calculateReproductionChance(cell.survival || 50, cell.energy, condition.temp, condition.pressure);
                    
                    if (Math.random() < survivalChance) {
                        survivors++;
                        if (Math.random() < reproductionChance) {
                            canReproduce++;
                        }
                    }
                });
                
                const survivalRate = (survivors / 1000 * 100).toFixed(1);
                const reproductionRate = (canReproduce / 1000 * 100).toFixed(1);
                
                let className = 'ok';
                if (condition.temp === -50 || condition.pressure === 100) {
                    if (survivors > 200) className = 'critical'; // –ë–æ–ª—å—à–µ 20% –ø—Ä–∏ —ç–∫—Å—Ç—Ä–∏–º–µ - –ø–ª–æ—Ö–æ
                    else if (survivors > 100) className = 'warning'; // –ë–æ–ª—å—à–µ 10% - –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ
                }
                
                results.innerHTML += `
                    <div class="test-result ${className}">
                        <strong>${condition.name}:</strong><br>
                        –í—ã–∂–∏–ª–æ: ${survivors}/1000 (${survivalRate}%)<br>
                        –†–∞–∑–º–Ω–æ–∂–∏–ª–æ—Å—å: ${canReproduce}/1000 (${reproductionRate}%)<br>
                        ${className === 'critical' ? '<span style="color:red;">‚ö†Ô∏è –°–õ–ò–®–ö–û–ú –ú–ù–û–ì–û –í–´–ñ–ò–í–®–ò–• –î–õ–Ø –≠–ö–°–¢–†–ò–ú–ê!</span>' : ''}
                        ${className === 'ok' && survivors < 50 ? '<span style="color:green;">‚úÖ –≠–§–§–ï–ö–¢–ò–í–ù–û–ï –í–´–ú–ò–†–ê–ù–ò–ï</span>' : ''}
                    </div>
                `;
            });
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        testSurvival();
    </script>
</body>
</html>